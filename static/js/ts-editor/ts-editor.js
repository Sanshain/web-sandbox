var tsEditor=function(exports){"use strict";function readFile(path,cb){fetch(path).then(function(r){return r.text()}).then(function(r){cb(r)}).catch(function(err){console.warn(arguments)})}function Range(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}}function stopPropagation(){this.propagationStopped=!0}function preventDefault(){this.defaultPrevented=!0}!function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var end=range.end,range=range.start,end=this.compare(end.row,end.column);return 1==end?1==(end=this.compare(range.row,range.column))?2:0==end?1:0:-1==end?-2:-1==(end=this.compare(range.row,range.column))?-1:1==end?42:0},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){range=this.compareRange(range);return-1==range||0==range||1==range},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)&&!this.isEnd(row,column)&&!this.isStart(row,column)},this.insideStart=function(row,column){return 0==this.compare(row,column)&&!this.isEnd(row,column)},this.insideEnd=function(row,column){return 0==this.compare(row,column)&&!this.isStart(row,column)},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?row<this.start.row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row!==row||column<=this.end.column?0:1:column<this.start.column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){var end,start;return this.end.row>lastRow?end={row:lastRow+1,column:0}:this.end.row<firstRow&&(end={row:firstRow,column:0}),this.start.row>lastRow?start={row:lastRow+1,column:0}:this.start.row<firstRow&&(start={row:firstRow,column:0}),Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var start,end,cmp=this.compare(row,column);return 0==cmp?this:(-1==cmp?start={row:row,column:column}:end={row:row,column:column},Range.fromPoints(start||this.start,end||this.end))},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),session=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,session.row,session.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}.call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column};var real,compliantExecNpcg,compliantLastIndexIncrement,Range_1=Range,EventEmitter={},EventEmitter_1=(EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){(e="object"==typeof e&&e?e:{}).type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault);for(var listeners=listeners.slice(),i=0;i<listeners.length&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){if(listeners=(this._eventRegistry||{})[eventName])for(var listeners=listeners.slice(),i=0;i<listeners.length;i++)listeners[i](e,this)},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var disabled,old,handlers=this._defaultHandlers;(handlers=handlers||(this._defaultHandlers={_disabled_:{}}))[eventName]&&(old=handlers[eventName],(disabled=handlers._disabled_[eventName])||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old),-1!=(old=disabled.indexOf(callback)))&&disabled.splice(old,1),handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var disabled,handlers=this._defaultHandlers;handlers&&(disabled=handlers._disabled_[eventName],handlers[eventName]==callback?(handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop())):disabled&&-1!=(handlers=disabled.indexOf(callback))&&disabled.splice(handlers,1))},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return-1==(listeners=listeners||(this._eventRegistry[eventName]=[])).indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};eventName=this._eventRegistry[eventName];eventName&&-1!==(callback=eventName.indexOf(callback))&&eventName.splice(callback,1)},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},EventEmitter),AutoCompleteView=function(){function AutoCompleteView(editor,autoComplete){this.editor=editor,this.autoComplete=autoComplete,this.selectedClassName="ace_autocomplete_selected",this.wrap=document.createElement("div"),this.listElement=document.createElement("ul"),this.wrap.className="ace_autocomplete",this.wrap.style.display="none",this.listElement.style.listStyleType="none",this.wrap.style.position="fixed",this.wrap.style.zIndex="1000",this.wrap.appendChild(this.listElement)}return AutoCompleteView.prototype.show=function(){return this.wrap.style.display="block"},AutoCompleteView.prototype.hide=function(){return this.wrap.style.display="none"},AutoCompleteView.prototype.setPosition=function(coords){var top=coords.pageY+20,editorBottom=this.editor.container.getBoundingClientRect().top+this.editor.container.offsetHeight,bottom=top+this.wrap.offsetHeight;return this.wrap.style.top=bottom<editorBottom?top+"px":top-this.wrap.offsetHeight-20+"px",this.wrap.style.left=coords.pageX+"px"},AutoCompleteView.prototype.current=function(){var child,i,children=this.listElement.childNodes;for(i in children)if((child=children[i]).className===this.selectedClassName)return child;return null},AutoCompleteView.prototype.focusNext=function(){var curr=this.current(),focus=curr.nextSibling;if(focus)return curr.className="",focus.className=this.selectedClassName,this.adjustPosition()},AutoCompleteView.prototype.focusPrev=function(){var curr=this.current(),focus=curr.previousSibling;if(focus)return curr.className="",focus.className=this.selectedClassName,this.adjustPosition()},AutoCompleteView.prototype.ensureFocus=function(){if(!this.current()&&this.listElement.firstChild)return this.listElement.firstChild.className=this.selectedClassName,this.adjustPosition()},AutoCompleteView.prototype.adjustPosition=function(){var elmOuterHeight,preMargin,wrapHeight,elm=this.current();elm&&(wrapHeight=this.wrap.offsetHeight,elmOuterHeight=elm.offsetHeight,preMargin=+getComputedStyle(this.listElement).marginTop.replace("px",""),wrapHeight-elmOuterHeight<=(wrapHeight={left:elm.offsetLeft,top:elm.offsetTop}).top&&(this.listElement.style.marginTop=preMargin-elmOuterHeight+"px"),wrapHeight.top<0)&&(this.listElement.style.marginTop=preMargin-wrapHeight.top+"px")},AutoCompleteView}(),EventEmitter={};function Empty(){}real={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},compliantExecNpcg=void 0===real.exec.call(/()??/,"")[1],x=/^/g,real.test.call(x,""),(compliantLastIndexIncrement=!x.lastIndex)&&compliantExecNpcg||(RegExp.prototype.exec=function(str){var name,regex,match=real.exec.apply(this,arguments);if("string"==typeof str&&match){if(!compliantExecNpcg&&1<match.length&&-1<function(array,item,from){if(Array.prototype.indexOf)return array.indexOf(item,from);for(var i=from||0;i<array.length;i++)if(array[i]===item)return i;return-1}(match,"")&&(regex=RegExp(this.source,real.replace.call(((regex=this).global?"g":"")+(regex.ignoreCase?"i":"")+(regex.multiline?"m":"")+(regex.extended?"x":"")+(regex.sticky?"y":""),"g","")),real.replace.call(str.slice(match.index),regex,function(){for(var i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(match[i]=void 0)})),this._xregexp&&this._xregexp.captureNames)for(var i=1;i<match.length;i++)(name=this._xregexp.captureNames[i-1])&&(match[name]=match[i]);!compliantLastIndexIncrement&&this.global&&!match[0].length&&this.lastIndex>match.index&&this.lastIndex--}return match},compliantLastIndexIncrement)||(RegExp.prototype.test=function(str){str=real.exec.call(this,str);return str&&this.global&&!str[0].length&&this.lastIndex>str.index&&this.lastIndex--,!!str}),Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){var result;return this instanceof bound?(result=target.apply(this,args.concat(slice.call(arguments))),Object(result)===result?result:this):target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,array_splice,x=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=x.bind(prototypeOfObject.toString),owns=x.bind(prototypeOfObject.hasOwnProperty);function makeArray(l){l=new Array(l+2);return l[0]=l[1]=0,l}(supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=x.bind(prototypeOfObject.__defineGetter__),defineSetter=x.bind(prototypeOfObject.__defineSetter__),lookupGetter=x.bind(prototypeOfObject.__lookupGetter__),lookupSetter=x.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length&&((prototypeOfArray=[]).splice.apply(prototypeOfArray,makeArray(20)),prototypeOfArray.splice.apply(prototypeOfArray,makeArray(26)),x=prototypeOfArray.length,prototypeOfArray.splice(5,0,"XXX"),x+1==prototypeOfArray.length?(array_splice=Array.prototype.splice,Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}):Array.prototype.splice=function(pos,removeCount){var length=this.length,removed=(0<pos?length<pos&&(pos=length):null==pos?pos=0:pos<0&&(pos=Math.max(length+pos,0)),this.slice(pos,pos+(removeCount=pos+removeCount<length?removeCount:length-pos))),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var removeCount=Math.min(removeCount,length-pos),tailOldPos=pos+removeCount,tailNewPos=tailOldPos+add-removeCount,tailCount=length-tailOldPos,length=length-removeCount;if(tailNewPos<tailOldPos)for(var i=0;i<tailCount;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailOldPos<tailNewPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===length)this.length=length,this.push.apply(this,insert);else for(this.length=length+add,i=0;i<add;++i)this[pos+i]=insert[i]}return removed}),Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var createEmpty,definePropertyFallback,freezeObject,x=Object("a"),splitString="a"!=x[0]||!(0 in x);function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;++i<length;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;i<length;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;i<length;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object))&&result.push(value);return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;i<length;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;i<length;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(2<=arguments.length)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;i<length;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(2<=arguments.length)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(--i<0)throw new TypeError("reduceRight of empty array with no initial value")}for(;i in this&&(result=fun.call(void 0,result,self[i],i,object)),i--;);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(length)for(var i=0,i=0<=(i=1<arguments.length?toInteger(arguments[1]):i)?i:Math.max(0,length+i);i<length;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(length)for(var i=length-1,i=0<=(i=1<arguments.length?Math.min(i,toInteger(arguments[1])):i)?i:length-Math.abs(i);0<=i;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+object);if(owns(object,property)){var descriptor={enumerable:!0,configurable:!0};if(supportsAccessors){var prototype=object.__proto__,getter=(object.__proto__=prototypeOfObject,lookupGetter(object,property)),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),Object.create||(createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var i,empty={};for(i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != 'object'");var Type=function(){};Type.prototype=prototype,(object=new Type).__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}),Object.defineProperty&&(prototypeOfArray=doesDefinePropertyWork({}),x="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div")),prototypeOfArray&&x||(definePropertyFallback=Object.defineProperty)),Object.defineProperty&&!definePropertyFallback||(Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.defineProperty called on non-object: "+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError("Property description must be an object: "+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value")){var prototype;supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))?(prototype=object.__proto__,object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype):object[property]=descriptor.value}else{if(!supportsAccessors)throw new TypeError("getters & setters can not be defined on this javascript engine");owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}),Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=(freezeObject=Object.freeze,function(object){return"function"==typeof object?object:freezeObject(object)})}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(object){return!1}),Object.isFrozen||(Object.isFrozen=function(object){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var key,hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var name,keys=[];for(name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;i<ii;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var trimBeginRegexp,trimEndRegexp,prototypeOfArray="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff";function toInteger(n){return(n=+n)!=n?n=0:0!==n&&n!==1/0&&n!==-1/0&&(n=(0<n||-1)*Math.floor(Math.abs(n))),n}String.prototype.trim&&!prototypeOfArray.trim()||(prototypeOfArray="["+prototypeOfArray+"]",trimBeginRegexp=new RegExp("^"+prototypeOfArray+prototypeOfArray+"*"),trimEndRegexp=new RegExp(prototypeOfArray+prototypeOfArray+"*$"),String.prototype.trim=function(){return String(this).replace(trimBeginRegexp,"").replace(trimEndRegexp,"")});var toObject=function(o){if(null==o)throw new TypeError("can't convert "+o+" to object");return Object(o)},oop={},x=(!function(exports){exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}(oop),!function(exports){var oop$1=oop,Keys=function(){var name,i,ret={MODIFIER_KEYS:{16:"Shift",17:"Ctrl",18:"Alt",224:"Meta"},KEY_MODS:{ctrl:1,alt:2,option:2,shift:4,super:8,meta:8,command:8,cmd:8},FUNCTION_KEYS:{8:"Backspace",9:"Tab",13:"Return",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock"},PRINTABLE_KEYS:{32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}};for(i in ret.FUNCTION_KEYS)name=ret.FUNCTION_KEYS[i].toLowerCase(),ret[name]=parseInt(i,10);for(i in ret.PRINTABLE_KEYS)name=ret.PRINTABLE_KEYS[i].toLowerCase(),ret[name]=parseInt(i,10);return oop$1.mixin(ret,ret.MODIFIER_KEYS),oop$1.mixin(ret,ret.PRINTABLE_KEYS),oop$1.mixin(ret,ret.FUNCTION_KEYS),ret.enter=ret.return,ret.escape=ret.esc,ret.del=ret.delete,ret[173]="-",function(){for(var mods=["cmd","ctrl","alt","shift"],i=Math.pow(2,mods.length);i--;)ret.KEY_MODS[i]=mods.filter(function(x){return i&ret.KEY_MODS[x]}).join("-")+"-"}(),ret.KEY_MODS[0]="",ret.KEY_MODS[-1]="input-",ret}();oop$1.mixin(exports,Keys),exports.keyCodeToString=function(keyCode){var keyString=Keys[keyCode];return(keyString="string"!=typeof keyString?String.fromCharCode(keyCode):keyString).toLowerCase()}}(EventEmitter),{}),keyUtil=(!function(exports){var os,ua;exports.OS={LINUX:"LINUX",MAC:"MAC",WINDOWS:"WINDOWS"},exports.getOS=function(){return exports.isMac?exports.OS.MAC:exports.isLinux?exports.OS.LINUX:exports.OS.WINDOWS},"object"==typeof navigator&&(os=(navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),ua=navigator.userAgent,exports.isWin="win"==os,exports.isMac="mac"==os,exports.isLinux="linux"==os,exports.isIE="Microsoft Internet Explorer"==navigator.appName||0<=navigator.appName.indexOf("MSAppHost")?parseFloat((ua.match(/(?:MSIE |Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]):parseFloat((ua.match(/(?:Trident\/[0-9]+[\.0-9]+;.*rv:)([0-9]+[\.0-9]+)/)||[])[1]),exports.isOldIE=exports.isIE&&exports.isIE<9,exports.isGecko=exports.isMozilla=(window.Controllers||window.controllers)&&"Gecko"===window.navigator.product,exports.isOldGecko=exports.isGecko&&parseInt((ua.match(/rv\:(\d+)/)||[])[1],10)<4,exports.isOpera=window.opera&&"[object Opera]"==Object.prototype.toString.call(window.opera),exports.isWebKit=parseFloat(ua.split("WebKit/")[1])||void 0,exports.isChrome=parseFloat(ua.split(" Chrome/")[1])||void 0,exports.isAIR=0<=ua.indexOf("AdobeAIR"),exports.isIPad=0<=ua.indexOf("iPad"),exports.isTouchPad=0<=ua.indexOf("TouchPad"),exports.isChromeOS=0<=ua.indexOf(" CrOS "))}(x),EventEmitter),useragent=x,KEY_MODS=keyUtil.KEY_MODS;function HashHandler(config,platform){this.platform=platform||(useragent.isMac?"mac":"win"),this.commands={},this.commandKeyBinding={},this.addCommands(config),this.$singleCommand=!0}!function(){function getPosition(command){return"object"==typeof command&&command.bindKey&&command.bindKey.position||0}this.addCommand=function(command){this.commands[command.name]&&this.removeCommand(command),(this.commands[command.name]=command).bindKey&&this._buildKeyHash(command)},this.removeCommand=function(command,keepCommand){var keyId,name=command&&("string"==typeof command?command:command.name),ckb=(command=this.commands[name],keepCommand||delete this.commands[name],this.commandKeyBinding);for(keyId in ckb){var i,cmdGroup=ckb[keyId];cmdGroup==command?delete ckb[keyId]:Array.isArray(cmdGroup)&&-1!=(i=cmdGroup.indexOf(command))&&(cmdGroup.splice(i,1),1==cmdGroup.length)&&(ckb[keyId]=cmdGroup[0])}},this.bindKey=function(key,command,position){if("object"==typeof key&&(null==position&&(position=key.position),key=key[this.platform]),key)return"function"==typeof command?this.addCommand({exec:command,bindKey:key,name:command.name||key}):void key.split("|").forEach(function(keyPart){var chain="",parts=(-1!=keyPart.indexOf(" ")&&(keyPart=(parts=keyPart.split(/\s+/)).pop(),parts.forEach(function(keyPart){keyPart=this.parseKeys(keyPart),keyPart=KEY_MODS[keyPart.hashId]+keyPart.key;chain+=(chain?" ":"")+keyPart,this._addCommandToBinding(chain,"chainKeys")},this),chain+=" "),this.parseKeys(keyPart)),keyPart=KEY_MODS[parts.hashId]+parts.key;this._addCommandToBinding(chain+keyPart,command,position)},this)},this._addCommandToBinding=function(keyId,command,position){var ckb=this.commandKeyBinding;if(command)if(!ckb[keyId]||this.$singleCommand)ckb[keyId]=command;else{Array.isArray(ckb[keyId])?-1!=(i=ckb[keyId].indexOf(command))&&ckb[keyId].splice(i,1):ckb[keyId]=[ckb[keyId]],"number"!=typeof position&&(position=position||command.isDefault?-100:getPosition(command));for(var commands=ckb[keyId],i=0;i<commands.length;i++)if(position<getPosition(commands[i]))break;commands.splice(i,0,command)}else delete ckb[keyId]},this.addCommands=function(commands){commands&&Object.keys(commands).forEach(function(name){var command=commands[name];if(command){if("string"==typeof command)return this.bindKey(command,name);"object"==typeof(command="function"==typeof command?{exec:command}:command)&&(command.name||(command.name=name),this.addCommand(command))}},this)},this.removeCommands=function(commands){Object.keys(commands).forEach(function(name){this.removeCommand(commands[name])},this)},this.bindKeys=function(keyList){Object.keys(keyList).forEach(function(key){this.bindKey(key,keyList[key])},this)},this._buildKeyHash=function(command){this.bindKey(command.bindKey,command)},this.parseKeys=function(keys){var parts=keys.toLowerCase().split(/[\-\+]([\-\+])?/).filter(function(x){return x}),key=parts.pop(),keyCode=keyUtil[key];if(keyUtil.FUNCTION_KEYS[keyCode])key=keyUtil.FUNCTION_KEYS[keyCode].toLowerCase();else{if(!parts.length)return{key:key,hashId:-1};if(1==parts.length&&"shift"==parts[0])return{key:key.toUpperCase(),hashId:-1}}for(var hashId=0,i=parts.length;i--;){var modifier=keyUtil.KEY_MODS[parts[i]];if(null==modifier)return"undefined"!=typeof console&&console.error("invalid modifier "+parts[i]+" in "+keys),!1;hashId|=modifier}return{key:key,hashId:hashId}},this.findKeyCommand=function(hashId,keyString){hashId=KEY_MODS[hashId]+keyString;return this.commandKeyBinding[hashId]},this.handleKeyboard=function(data,hashId,keyString,keyCode){var key=KEY_MODS[hashId]+keyString,command=this.commandKeyBinding[key];return data.$keyChain&&(data.$keyChain+=" "+key,command=this.commandKeyBinding[data.$keyChain]||command),!command||"chainKeys"!=command&&"chainKeys"!=command[command.length-1]?(data.$keyChain&&(hashId&&4!=hashId||1!=keyString.length?(-1==hashId||0<keyCode)&&(data.$keyChain=""):data.$keyChain=data.$keyChain.slice(0,-key.length-1)),{command:command}):(data.$keyChain=data.$keyChain||key,{command:"null"})},this.getStatusText=function(editor,data){return data.$keyChain||""}}.call(HashHandler.prototype);var HashHandler_1=HashHandler,AutoComplete=function(editor,script,completionService){var _this=this,self=(this.editor=editor,this.script=script,this.completionService=completionService,this.isActive=function(){return _this._active},this.setScriptName=function(name){_this.scriptName=name},this.show=function(){_this.listElement=_this.view.listElement,_this.editor.container.appendChild(_this.view.wrap),_this.listElement.innerHTML=""},this.hide=function(){_this.view.hide()},this.compilation=function(cursor){function matchFunc(elm){return 0==elm.name.indexOf(_this.inputText)?1:0}var compilationInfo=_this.completionService.getCursorCompilation(_this.scriptName,cursor),text=_this.completionService.matchText,cursor=_this.editor.renderer.textToScreenCoordinates(cursor.row,cursor.column-text.length),cursor=(_this.view.setPosition(cursor),_this.inputText=text,compilationInfo||console.log("`compilationInfo` is undefined"),(compilationInfo||{entries:[]}).entries),matchCompare=(0<_this.inputText.length&&compilationInfo&&(cursor=compilationInfo.entries.filter(function(elm){return 0==elm.name.toLowerCase().indexOf(_this.inputText.toLowerCase())})),function(a,b){return matchFunc(b)-matchFunc(a)}),textCompare=function(a,b){return a.name==b.name?0:a.name>b.name?1:-1};return cursor=(cursor=cursor.sort(function(a,b){var ret=matchCompare(a,b);return 0!=ret?ret:textCompare(a,b)})).filter(function(k){return!~k.name.indexOf("_")}),_this.showCompilation(cursor),cursor.length},this.refreshCompletions=function(e){var cursor=_this.editor.getCursorPosition(),data=e,data=_this.editor.getSession().getTextRange(new Range_1(data.start.row,data.start.column,data.end.row,data.end.column));if("insert"==e.action)cursor.column+=1;else if("remove"==e.action&&"\n"==data)return void _this.deactivate();_this.compilation(cursor)},this.showCompilation=function(infos){if(0<infos.length){_this.view.show();var n,html="";for(n in infos){var info=infos[n],name='<span class="label-name">'+info.name+"</span>",type='<span class="label-type">'+info.kind+"</span>",kind='<span class="label-kind label-kind-'+info.kind+'">'+info.kind.charAt(0)+"</span>";html+='<li data-name="'+info.name+'">'+kind+name+type+"</li>"}_this.listElement.innerHTML=html,_this.view.ensureFocus()}else _this.view.hide()},this.active=function(){_this.show(),0<_this.compilation(_this.editor.getCursorPosition())?_this.editor.keyBinding.addKeyboardHandler(_this.handler):_this.hide()},this.deactivate=function(){_this.editor.keyBinding.removeKeyboardHandler(_this.handler)},oop.implement(this,EventEmitter_1),this.handler=new HashHandler_1,this.view=new AutoCompleteView(editor,this),this.scriptName=script,this._active=!1,this.inputText="",this.handler.attach=function(){editor.addEventListener("change",_this.refreshCompletions),_this._emit("attach",{sender:_this}),_this._active=!0},this.handler.detach=function(){editor.removeEventListener("change",_this.refreshCompletions),_this.view.hide(),_this._emit("detach",{sender:_this}),_this._active=!1},this);this.handler.handleKeyboard=function(data,hashId,key,keyCode){if(-1==hashId)-1!=" -=,[]_/()!';:<>".indexOf(key)&&self.deactivate();else{var args,command=self.handler.findKeyCommand(hashId,key);if(command)return"string"!=typeof command&&(args=command.args,command=command.command),{command:command="string"==typeof command?this.commands[command]:command,args:args};command=editor.commands.findKeyCommand(hashId,key);if(command){if("backspace"==command.name)return null;self.deactivate()}}return null},this.handler.bindKeys({"Up|Ctrl-p":"focusprev","Down|Ctrl-n":"focusnext","esc|Ctrl-g":"cancel","Return|Tab":"insertComplete"}),this.handler.addCommands({focusnext:function(editor){self.view.focusNext()},focusprev:function(editor){self.view.focusPrev()},cancel:function(editor){self.deactivate()},insertComplete:function(editor){editor.removeEventListener("change",self.refreshCompletions);for(var curr=self.view.current(),i=0;i<self.inputText.length;i++)editor.remove("left");curr&&editor.insert(curr.getAttribute("data-name")),self.deactivate()}})},EditorPosition=function(){function EditorPosition(editor){var _this=this;this.editor=editor,this.getPositionChars=function(pos){var doc=editor.getSession().getDocument();return _this.getChars(doc,pos)},this.getAcePositionFromChars=function(chars){var doc=editor.getSession().getDocument();return _this.getPosition(doc,chars)},this.getCurrentCharPosition=function(){return _this.getPositionChars(editor.getCursorPosition())},this.getCurrentLeftChar=function(){return _this.getPositionLeftChar(editor.getCursorPosition())},this.getPositionChar=function(cursor){cursor={start:{row:cursor.row,column:cursor.column},end:{row:cursor.row,column:cursor.column+1}};return editor.getSession().getDocument().getTextRange(cursor)},this.getPositionLeftChar=function(cursor){cursor={start:{row:cursor.row,column:cursor.column},end:{row:cursor.row,column:cursor.column-1}};return editor.getSession().getDocument().getTextRange(cursor)}}return EditorPosition.prototype.getLinesChars=function(lines){var count=0;return lines.forEach(function(line){return count+=line.length+1}),count},EditorPosition.prototype.getChars=function(doc,pos){return this.getLinesChars(doc.getLines(0,pos.row-1))+pos.column},EditorPosition.prototype.getPosition=function(doc,chars){var i,line,lines=doc.getAllLines(),count=0,row=0;for(i in lines){if(chars<count+((line=lines[i]).length+1))return{row:row,column:chars-count};count+=line.length+1,row+=1}return{row:row,column:chars-count}},EditorPosition}();function clone(target){return function(target){for(var items=[],_i=1;_i<arguments.length;_i++)items[_i-1]=arguments[_i];return items.reduce(function(target,source){return Object.keys(source).reduce(function(target,key){return target[key]=source[key],target},target)},target)}(Array.isArray(target)?[]:{},target)}function createLanguageServiceHost(currentDir,defaultLibFileName){var compilationSettings,fileNameToScript=Object.create(null);return{log:function(){return null},error:function(){return null},trace:function(){return null},addScript:function(fileName,content){content=function(content){var scriptVersion=1,editRanges=[],isOpen=!1,_lineStartIsDirty=!0;return{getContent:function(){return content},getVersion:function(){return scriptVersion},getIsOpen:function(){return isOpen},setIsOpen:function(val){return isOpen=val},getScriptSnapshot:function(){_lineStartIsDirty&&(ts.computeLineStarts(content),_lineStartIsDirty=!1);var textSnapshot=content,version=scriptVersion;return editRanges.slice(),{getText:function(start,end){return textSnapshot.substring(start,end)},getLength:function(){return textSnapshot.length},getChangeRange:function(oldSnapshot){var unchanged={span:{start:0,length:0},newLength:0};if((oldSnapshot=oldSnapshot.version||0)===version)return unchanged;if((oldSnapshot=editRanges.length-(version-oldSnapshot))<0)return null;var changes=editRanges.slice(oldSnapshot);if(0===changes.length)return unchanged;if(1===changes.length)return changes[0];for(var oldStartN=(oldSnapshot=changes[0]).span.start,oldEndN=oldSnapshot.span.start+oldSnapshot.span.length,newEndN=oldStartN+oldSnapshot.newLength,i=1;i<changes.length;i++)var nextChange=changes[i],oldStart1=oldStartN,oldEnd1=oldEndN,newEnd1=newEndN,oldStart2=nextChange.span.start,oldEnd2=nextChange.span.start+nextChange.span.length,nextChange=oldStart2+nextChange.newLength,oldStartN=Math.min(oldStart1,oldStart2),oldEndN=Math.max(oldEnd1,oldEnd1+(oldEnd2-newEnd1)),newEndN=Math.max(nextChange,nextChange+(newEnd1-oldEnd2));return{span:{start:oldStartN,length:oldEndN-oldStartN},newLength:newEndN-oldStartN}}}},updateContent:function(newContent){newContent!==content&&(content=newContent,_lineStartIsDirty=!0,editRanges=[],scriptVersion++)},editContent:function(minChar,limChar,newText){content=content.substring(0,minChar)+newText+content.substring(limChar),_lineStartIsDirty=!0,editRanges.push({span:{start:minChar,length:limChar-minChar},newLength:newText.length}),scriptVersion++}}}(content),fileNameToScript[fileName]=content},removeScript:function(fileName){delete fileNameToScript[fileName]},removeAll:function(){fileNameToScript=Object.create(null)},updateScript:function(fileName,content){var script=fileNameToScript[fileName];if(script)return script.getContent()==content?void 0:void script.updateContent(content);throw new Error("No script with name '"+fileName+"'")},hasScript:function(fileName){return!!fileNameToScript[fileName]},editScript:function(fileName,minChar,limChar,newText){var script=fileNameToScript[fileName];if(!script)throw new Error("No script with name '"+fileName+"'");script.editContent(minChar,limChar,newText)},getScriptContent:function(fileName){return(fileName=fileNameToScript[fileName])?fileName.getContent():null},setCompilationSettings:function(settings){compilationSettings=Object.freeze(clone(settings))},setScriptIsOpen:function(fileName,isOpen){var script=fileNameToScript[fileName];if(!script)throw new Error("No script with name '"+fileName+"'");script.setIsOpen(isOpen)},getCompilationSettings:function(){return compilationSettings},getScriptFileNames:function(){return Object.keys(fileNameToScript)},getCurrentDirectory:function(){return currentDir},getDefaultLibFileName:function(){return defaultLibFileName},getScriptVersion:function(fileName){return(fileName=fileNameToScript[fileName])?""+fileName.getVersion():"0"},getScriptSnapshot:function(fileName){return(fileName=fileNameToScript[fileName])?fileName.getScriptSnapshot():null}}}"undefined"!=typeof importScripts&&void 0===globalThis.ts&&importScripts("https://cdnjs.cloudflare.com/ajax/libs/typescript/4.6.4/typescript.min.js");var TsProject=function(){this.languageServiceHost=createLanguageServiceHost("","typescripts/lib.d.ts"),this.languageService=ts.createLanguageService(this.languageServiceHost,ts.createDocumentRegistry())},tsProject$2=null;function getTSProject(){return tsProject$2=tsProject$2||new TsProject}var tsProject$1=getTSProject(),CompletionService=function(){function CompletionService(editor){this.editor=editor,this.editorPos=new EditorPosition(editor)}return CompletionService.prototype.getCompilation=function(script,charpos,isMemberCompletion){return tsProject$1.languageService.getCompletionsAtPosition(script,charpos,{})},CompletionService.prototype.getCursorCompilation=function(script,cursor){var pos=this.editorPos.getPositionChars(cursor),cursor=this.editor.session.getLine(cursor.row).slice(0,cursor.column),isMemberCompletion=!1,matches=cursor.match(/\.([a-zA-Z_0-9\$]*$)/);return matches&&0<matches.length?(this.matchText=matches[1],isMemberCompletion=!0,pos-=this.matchText.length):(matches=cursor.match(/[a-zA-Z_0-9\$]*$/),this.matchText=matches[0]),this.getCompilation(script,pos,isMemberCompletion)},CompletionService.prototype.getCurrentPositionCompilation=function(script){return this.getCursorCompilation(script,this.editor.getCursorPosition())},CompletionService}();function defaultFormatCodeOptions(){return{IndentSize:4,TabSize:4,NewLineCharacter:"\n",ConvertTabsToSpaces:!0,InsertSpaceAfterCommaDelimiter:!0,InsertSpaceAfterSemicolonInForStatements:!0,InsertSpaceBeforeAndAfterBinaryOperators:!0,InsertSpaceAfterKeywordsInControlFlowStatements:!0,InsertSpaceAfterFunctionKeywordForAnonymousFunctions:!1,InsertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis:!1,PlaceOpenBraceOnNewLineForFunctions:!1,PlaceOpenBraceOnNewLineForControlBlocks:!1,IndentStyle:0,InsertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets:!1,InsertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces:!1}}var ace=window.ace,aceEditorPosition=null,signatureToolTip=null,originalTextInput=null,closuredEvents={},fileNavigator=null,editor=null,selectFileName="",syncStop=!1,autoComplete=null,refMarkers=[],errorMarkers=[],tsProject=getTSProject();function loadLibFiles(libFiles){return(libFiles=libFiles||["/typescripts/4.9.5/lib.dom.d.ts","/typescripts/4.9.5/lib.es5.d.ts","/typescripts/4.9.5/lib.dom.iterable.d.ts"]).forEach(function(libname){!1===tsProject.languageServiceHost.hasScript(libname)&&readFile(libname,function(content){tsProject.languageServiceHost.addScript(libname,content)})}),function workerOnCreate(func,timeout){editor.getSession().$worker?func(editor.getSession().$worker):setTimeout(function(){workerOnCreate(func)})}(function(){libFiles.forEach(function(libname){readFile(libname,function(content){content={data:{name:libname,content:content}};editor.getSession().$worker.emit("addLibrary",content)})})}),tsProject.languageServiceHost}function loadContent(filename,content,keepExistContent){selectFileName=filename,syncStop=!0,keepExistContent||(keepExistContent=content.replace(/\r\n?/g,"\n"),editor.session.setValue(keepExistContent)),tsProject.languageServiceHost.addScript(filename,editor.getSession().getDocument().getValue()),syncStop=!1}var tsServiceHandler={loadPackages:loadLibFiles,loadContent:loadContent,changeSelectFileName:function(filename){selectFileName=filename},removeFile:tsProject.languageServiceHost.removeScript,getLoadedFilenames:tsProject.languageServiceHost.getScriptFileNames,hasFile:tsProject.languageServiceHost.hasScript,updateFile:tsProject.languageServiceHost.updateScript,editFile:tsProject.languageServiceHost.editScript,setCompilationSettings:tsProject.languageServiceHost.setCompilationSettings,getCompilationSettings:tsProject.languageServiceHost.getCompilationSettings};function onUpdateDocument(e){var script,data,action,start,end;selectFileName&&!syncStop&&(script=selectFileName,action=(data=e).action,start=aceEditorPosition.getPositionChars(data.start),end=aceEditorPosition.getPositionChars(data.end),data=editor.getSession().getTextRange(new Range_1(data.start.row,data.start.column,data.end.row,data.end.column)),"insert"==action?editLanguageService(script,start,start,data):"remove"==action?editLanguageService(script,start,end,""):console.error("unknown action:",action),function(data){var action=data.action,action=data.action,newText=(aceEditorPosition.getPositionChars(data.start),aceEditorPosition.getPositionChars(data.end),editor.getSession().getTextRange(new Range_1(data.start.row,data.start.column,data.end.row,data.end.column))),markers=editor.getSession().getMarkers(!0),line_count=0,isNewLine=editor.getSession().getDocument().isNewLine;"insert"==action?isNewLine(newText)&&(line_count=1):"remove"==action&&isNewLine(newText)&&(line_count=-1);0!=line_count&&(action=function(id){var id=markers[id],row=data.start.row;0<line_count&&(row=1),id&&id.range.start.row>row&&(id.range.start.row+=line_count,id.range.end.row+=line_count)},errorMarkers.forEach(action),refMarkers.forEach(action),editor.onChangeFrontMarker())}(e))}function editLanguageService(name,minChar,limChar,newText){tsProject.languageServiceHost.editScript(name,minChar,limChar,newText)}function onChangeCursor(e){if(!syncStop)try{deferredShowOccurrences.schedule(200)}catch(ex){}}function languageServiceIndent(){var cursor=editor.getCursorPosition(),lineNumber=cursor.row,matches=editor.session.getLine(lineNumber).match(/^[\t ]*/),preIndent=0,wordLen=0;if(matches)for(var wordLen=matches[0].length,i=0;i<matches[0].length;i++)preIndent+=" "==matches[0].charAt(i)?1:editor.session.getTabSize();var lineNumber=tsProject.languageService.getIndentationAtPosition(selectFileName,lineNumber,defaultFormatCodeOptions());lineNumber<preIndent?editor.indent():(0<(lineNumber=lineNumber-preIndent)&&(editor.getSelection().moveCursorLineStart(),editor.commands.exec("inserttext",editor,{text:" ",times:lineNumber})),cursor.column>wordLen?cursor.column+=lineNumber:cursor.column=lineNumber+wordLen,editor.getSelection().moveCursorToPosition(cursor))}function refactor(){tsProject.languageService.getOccurrencesAtPosition(selectFileName,aceEditorPosition.getCurrentCharPosition()).forEach(function(ref){var getpos=aceEditorPosition.getAcePositionFromChars,start=getpos(ref.textSpan.start),getpos=getpos(ref.textSpan.start+ref.textSpan.length),ref=new Range_1(start.row,start.column,getpos.row,getpos.column);editor.selection.addRange(ref)})}fcn=function(){var session=editor.getSession(),references=(refMarkers.forEach(function(id){session.removeMarker(id)}),tsProject.languageService.getOccurrencesAtPosition(selectFileName,aceEditorPosition.getCurrentCharPosition()));references&&references.forEach(function(ref){var getpos=aceEditorPosition.getAcePositionFromChars,start=getpos(ref.textSpan.start),getpos=getpos(ref.textSpan.start+ref.textSpan.length),ref=new Range_1(start.row,start.column,getpos.row,getpos.column);refMarkers.push(session.addMarker(ref,"typescript-ref","text",!0))})},timer=null,(deferred.schedule=deferred).call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer};var fcn,timer,deferredShowOccurrences=deferred;function callback(){timer=null,fcn()}function deferred(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred}function enableHinter(e){signatureToolTip&&(signatureToolTip.parentElement?signatureToolTip.parentElement.removeChild(signatureToolTip):signatureToolTip.remove&&signatureToolTip.remove());var textInputBound,pos=editor.getCursorPosition(),arr=editor.session.getTextRange(new Range_1(0,0,pos.row,pos.column)).split("\n"),arr=arr.length+arr.reduce(function(acc,line){return acc+line.length},0),pos=editor.session.getTokenAt(pos.row,pos.column);pos&&"("==pos.value&&(pos=tsProject.languageService.getDefinitionAtPosition(fileNavigator._active||"samples/greeter.ts",arr-2))&&pos.length&&~["function","method"].indexOf(pos[0].kind)&&(arr=tsProject.languageService.getQuickInfoAtPosition(fileNavigator._active||"samples/greeter.ts",arr-2))&&Array.isArray(arr.displayParts)&&(arr=arr.displayParts.filter(function(k){return"parameterName"==k.kind}).map(function(k){return k.text}),textInputBound=editor.textInput.getElement().getBoundingClientRect(),(signatureToolTip=editor.container.appendChild(document.createElement("div"))).className="tooltip",signatureToolTip.style.top=textInputBound.top+2+"px",signatureToolTip.style.left=textInputBound.left+10+"px",signatureToolTip.innerText=pos[0].name+"("+arr.toString().split(",").join(", ")+")")}return exports.dropMode=function(editor){return editor.removeEventListener("change",onUpdateDocument),editor.removeEventListener("changeSelection",onChangeCursor),editor.session.selection.off("changeCursor",enableHinter),["autoComplete","refactor","indent"].forEach(function(w){return editor.commands.removeCommand(w,!0)}),editor.onTextInput=originalTextInput,editor.removeEventListener("mousedown",closuredEvents.mousedown),editor.session.off("compileErrors",closuredEvents.compileErrors),editor},exports.initialize=function(options){fileNavigator=(options=options||{}).fileNavigator=options.fileNavigator||{_active:options.entryFile||"app.ts"};var filename,selector=options.selector||"editor";return editor=options.editor||ace.edit(selector),options.editor||editor.setTheme("ace/theme/monokai"),editor.getSession().setMode("ace/mode/typescript"),selector&&(selector=document.getElementById(selector))&&(selector.style.fontSize=options.fontSize||"14px"),loadLibFiles(options.libFiles),options.content||options.editor?loadContent(options.entryFile||options.fileNavigator._active||"app.ts",options.content||options.editor.getValue(),!!options.editor):options.editor||readFile(filename=options.entryFile||"samples/greeter.ts",function(content){loadContent(filename,content)}),editor.addEventListener("change",onUpdateDocument),editor.addEventListener("changeSelection",onChangeCursor),options.signatureToolTip&&editor.session.selection.on("changeCursor",enableHinter),options.position&&editor.moveCursorTo(options.position.row,options.position.column),editor.commands.addCommands([{name:"autoComplete",bindKey:"Ctrl-Space",exec:function(editor){0==autoComplete.isActive()&&(autoComplete.setScriptName(selectFileName),autoComplete.active())}},{name:"refactor",bindKey:"F2",exec:function(editor){refactor()}},{name:"indent",bindKey:"Tab",exec:function(editor){languageServiceIndent()}}]),aceEditorPosition=new EditorPosition(editor),autoComplete=new AutoComplete(editor,selectFileName,new CompletionService(editor)),originalTextInput=editor.onTextInput,editor.onTextInput=function(text){originalTextInput.call(editor,text);var pos=editor.getCursorPosition(),pos=editor.session.getTokenAt(pos.row,pos.column);pos&&1<pos.value.length&&pos.value.match(/\w[\w\d_\$]+/)||"."==text?editor.execCommand("autoComplete"):editor.getSession().getDocument().isNewLine(text)&&(pos=editor.getCursorPosition().row,text=defaultFormatCodeOptions(),0<tsProject.languageService.getIndentationAtPosition(selectFileName,pos,text))&&editor.commands.exec("inserttext",editor,{text:" ",times:text.IndentSize-5})},editor.addEventListener("mousedown",closuredEvents.mousedown=function(e){autoComplete.isActive()&&autoComplete.deactivate()}),editor.getSession().on("compiled",function(e){}),editor.getSession().on("compileErrors",closuredEvents.compileErrors=function(e){var session=editor.getSession();errorMarkers.forEach(function(id){session.removeMarker(id)}),e.data.forEach(function(error){var getpos=aceEditorPosition.getAcePositionFromChars,start=getpos(error.minChar),getpos=getpos(error.limChar),error=new Range_1(start.row,start.column,getpos.row,getpos.column);errorMarkers.push(session.addMarker(error,"typescript-error","text",!0))})}),[tsServiceHandler,editor]},Object.defineProperty(exports,"__esModule",{value:!0}),exports}({});
//# sourceMappingURL=ts-editor.js.map
