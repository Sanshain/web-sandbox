{"version":3,"file":"page_compiler.js","sources":["../source/features/compiler.js","../source/utils/page_generator.js","../source/utils/utils.js","../source/utils/linter.js","../source/ui/ChoiceMenu.js","../source/features/base.js","../source/pageBuilder.js"],"sourcesContent":["//@ts-check\r\n\r\n\r\n\r\n\r\nconst reactCompiler = {\r\n    react: 'https://unpkg.com/react@17/umd/react.production.min.js',\r\n    reactDOM: 'https://unpkg.com/react-dom@17/umd/react-dom.production.min.js',\r\n}\r\n\r\nconst vueCompiler = {\r\n    // vue: \"https://unpkg.com/vue@2.5.17/dist/vue.js\"\r\n    vue: 'https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.14/vue.min.js'\r\n}\r\n\r\nconst preactCompiler = {\r\n    // set: './build/_preact.js',\r\n    // set: '~/build/_preact.js',\r\n\r\n    // preact: 'https://cdnjs.cloudflare.com/ajax/libs/preact/11.0.0-experimental.1/preact.umd.min.js',     // preact\r\n    // hooks: 'https://cdnjs.cloudflare.com/ajax/libs/preact/11.0.0-experimental.1/hooks.umd.min.js',      // hooks\r\n    // compat: 'https://cdnjs.cloudflare.com/ajax/libs/preact/11.0.0-experimental.1/compat.umd.min.js'     // react\r\n\r\n    // set: 'http://127.0.0.1:3000/build/_preact.js',\r\n\r\n    set: document.location.origin + (~document.location.host.indexOf('3000') ? '/build/_preact.js' : '/static/js/compiler_libs/_preact.js'),\r\n}\r\n\r\n\r\nexport const babelCompiler = {\r\n    link: 'https://unpkg.com/@babel/standalone/babel.min.js',\r\n    mode: ' type=\"text/babel\" '\r\n}\r\n\r\n\r\n// export const reactCompilers = [babelCompiler.link, reactCompiler.react, reactCompiler.reactDOM];\r\n\r\n// export const reactCompilers = [\r\n//     preactCompiler.set,\r\n//     babelCompiler.link,\r\n// ];\r\n\r\n// export const reactCompilers = [\r\n//     vueCompiler.vue\r\n// ];\r\n\r\n\r\nexport const compilers = {\r\n    vanile: undefined,\r\n    preact: [babelCompiler.link].concat(Object.values(preactCompiler)),\r\n    vue: Object.values(vueCompiler),\r\n    react: [babelCompiler.link].concat(Object.values(reactCompiler)),    \r\n};\r\n\r\n\r\nexport const defaultValues = [\r\n    // html\r\n    {\r\n        html: '<h2 onclick=\"greeting(event)\">\\n\\tHello world!\\n</h2>',\r\n        css: 'h2 {\\n\\tcolor: green;\\n\\tcursor: pointer; \\n}',\r\n        javascript: 'function greeting(event){\\n\\talert(\"greeting!\")\\n}'\r\n    },\r\n    // preact\r\n    {\r\n        html: '<div id=\"root\"></div>',\r\n        css: '#root{\\n\\tcolor: red;\\n}',\r\n        javascript: \"const name = 'world'; \\nrender(\\n\\t<h1>Hello {name}</h1>, \\n\\tdocument.getElementById('root')\\n);\"\r\n    },\r\n    // vue\r\n    {\r\n        html: '<div id=\"app\">\\n\\t<input type=\"text\" v-on:input=\"setMsg\" />\\n\\t<p>{{msg}}</p>\\n</div>',\r\n        css: '#app { \\n\\tcolor: green; \\n}',\r\n        javascript: \"new Vue({\\n\\tel: '#app', \\n\\tdata: {\\n\\t\\tmsg: 'Hello Vue!'\\n\\t}, \\n\\tmethods: {\\n\\t\\tsetMsg: function(e){\\n\\t\\t\\tthis.msg = e.target.value;\\n\\t\\t}\\n\\t}\\n})\"\r\n    },\r\n    // react\r\n    {\r\n        html: '<div id=\"root\"></div>',\r\n        css: '#root{\\n\\tcolor: red;\\n}\\nh1{\\n\\tcursor: pointer;\\n\\tuser-select: none;\\n}',\r\n        // javascript: \"const name = 'world'; \\n\\nReactDOM.render(\\n\\t<h1>Привет, {name}!</h1>, \\n\\tdocument.getElementById('root')\\n);\"\r\n        javascript: \"const name = 'world';\\n\\nfunction App(){\\n\\tconst [count, setCount] = React.useState(0);\" +\r\n                    \"\\n\\treturn <h1 onClick={()=>setCount(count+1)}>Привет, {name} {count}!</h1>;\\n}\\n\\nReactDOM.render(\\n\\t<App/>,\\n\\tdocument.getElementById('root')\\n);\"\r\n    },\r\n]","/**\r\n * initialize global funcs in the sandbox\r\n * \r\n * (обработчики событий, назначенных в атрибутах, должны быть глобальными. Назначаем их глобальными здесь)\r\n * \r\n * @param {*} code \r\n * @returns \r\n */\r\nexport function generateGlobalInintializer(code) {\r\n\r\n    let globalInit = (code.match(/function ([\\w\\d_]+)\\s?\\(/gm) || [])\r\n        .map(it => it.split(' ')[1].replace('(', '').trim())\r\n        .map(it => 'globalThis.' + it + ' = ' + it).join(';\\n');\r\n\r\n    return globalInit;\r\n}\r\n\r\n\r\nexport const isPaired = (/** @type {string} */ tag) => !~['link'].indexOf(tag);","//@ts-check\r\n\r\nimport { playgroundObject } from \"../pageBuilder\";\r\n\r\nexport const commonStorage = sessionStorage;\r\n\r\n/**\r\n * @param {{ (): number; (): any; }} func\r\n * @param {number} delay\r\n */\r\nexport function debounce(func, delay) {\r\n    \r\n    let inAwaiting = false;\r\n\r\n    return function ()\r\n    {\r\n        if (!inAwaiting) {\r\n\r\n            let result = func();\r\n\r\n            inAwaiting = true;\r\n            setTimeout(() => inAwaiting = false, delay);\r\n\r\n            return result;\r\n        }\r\n    };\r\n}\r\n\r\n\r\n\r\n/**\r\n * extracts lang mode from code text\r\n * \r\n * @param {string} code\r\n * @returns {string|null}\r\n */\r\nexport function getLangMode(code)\r\n{\r\n    let langModeMatch = code.match(/\\/\\* ([\\w \\n]+) \\*\\//);\r\n\r\n    return langModeMatch\r\n        ? langModeMatch.pop()\r\n        : null;\r\n}\r\n\r\n\r\n/**\r\n * @param {string} prevName\r\n * @param {string} fullname\r\n * @param {{ find: (arg0: string) => any; getSession: () => string; }} editor\r\n */\r\nfunction renameOccurrences(prevName, fullname, editor) {\r\n    let fileStore = playgroundObject.fileStorage\r\n    fileStore[fullname] = fileStore[prevName];\r\n    delete fileStore[prevName];\r\n\r\n    for (let file in playgroundObject.fileStorage) {\r\n        if (typeof playgroundObject.fileStorage[file] === 'string') {\r\n            playgroundObject.fileStorage[file] = playgroundObject.fileStorage[file].replace(prevName, fullname);\r\n        }\r\n    }\r\n\r\n    let pos = editor.find(prevName + \"'\")\r\n    pos && editor.getSession().replace(pos, fullname + \"'\")\r\n}\r\n","export const html = (/** @type {ReadonlyArray<string>} */ text, /** @type {any[]} */ ...args) => text.reduce((p, n, i) => p + args[i - 1] + n);","//@ts-check\r\n\r\nimport { html } from \"./../utils/linter\";\r\n\r\n\r\n// HTMLElement\r\nexport class ChoiceMenu extends HTMLElement {\r\n\r\n    itemStyle = ' \\\r\n        color: white; \\\r\n        background-color: #666; \\\r\n        padding: 0.1em 1em 0.1em 2em; \\\r\n        margin-top: 1px; \\\r\n        text-align: right; \\\r\n        position: relative; '\r\n\r\n\r\n    /** selected element\r\n     * @type {HTMLElement}\r\n     */\r\n    selectedElement = null;\r\n\r\n    /** checked mark // only for external slot //\r\n     * @type {HTMLElement}\r\n     */\r\n    checkedElement = null;\r\n\r\n    /** ul\r\n     * @type {HTMLUListElement}\r\n     */\r\n    rootElement = null;\r\n\r\n    /** selected info\r\n     * @type {{id: string, metaId: string, value: string}}\r\n     */\r\n    checkInfo = null;\r\n\r\n    /// \r\n    //@ts-ignore\r\n    itemInitialize = (/** @type {HTMLLIElement} */ el) => ((el.onclick = (/** @type {Event} */ e) => this.selectedChanged(e)), el.style = this.itemStyle)\r\n\r\n    // get rootElement() { return this._rootElement; };\r\n    // set rootElement(v) {\r\n    //     console.log(v);\r\n    //     this._rootElement = v;\r\n    // }\r\n\r\n    \r\n    /** \r\n     * @deprecated\r\n     * @type number\r\n     */\r\n    // @ts-ignore    \r\n    get selectedIndex() {\r\n        let index = [].slice.call(this.rootElement.querySelectorAll('li')).indexOf(this.rootElement.querySelector('.selected'));\r\n        return index;\r\n    };\r\n    \r\n\r\n    /**\r\n     * @type string\r\n     */\r\n    // @ts-ignore\r\n    get selectedItem() {\r\n        //@ts-ignore\r\n        // return (this.rootElement.querySelector('.selected') || {}).innerText\r\n        return this.selectedElement.innerText;\r\n    };\r\n\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        /// base vars\r\n\r\n        //@ts-ignore\r\n        const rootElement = document.getElementById('choice-menu').content.cloneNode(true);\r\n        const shadowRoot = this.attachShadow({ mode: 'open' }).appendChild(rootElement);\r\n\r\n\r\n        // tactic vars\r\n\r\n        //\r\n        let menuElement = this.rootElement = this.shadowRoot.querySelector('ul');\r\n\r\n\r\n        // initialization event\r\n        const self = this; this.shadowRoot.addEventListener(\"slotchange\", function (event) {\r\n            //@ts-ignore\r\n            [menuElement] = [self.rootElement] = event.target.assignedElements();\r\n            self.checkedElement = self.shadowRoot.querySelector('.checked');\r\n            [].slice.call(self.rootElement.querySelectorAll('li')).forEach(self.itemInitialize);\r\n        });\r\n\r\n\r\n        // other events:                    \r\n        this.addEventListener('opened', () => this.pickItem(this.selectedElement))\r\n        this.addEventListener('click', this.visibleChanged);\r\n\r\n\r\n        /// only default slot:\r\n        this.rootElement.addEventListener('click', this.selectedChanged)\r\n    }\r\n\r\n\r\n    ///\r\n    visibleChanged() {\r\n\r\n        const self = this;\r\n        const opened = this.rootElement.classList.contains('active');\r\n\r\n        setTimeout(\r\n            () => {\r\n                self.rootElement.classList.toggle('active');\r\n                setTimeout(() => self.checkedElement && self.checkedElement.classList.toggle('active'), +!opened * 200)\r\n            },\r\n            +opened * 150\r\n        );\r\n\r\n        this.dispatchEvent(new CustomEvent(opened ? 'closed' : 'opened', { detail: null }))\r\n    }\r\n\r\n\r\n    /**\r\n     * \r\n     * @param {HTMLElement} element \r\n     */\r\n    pickItem(element) {\r\n        setTimeout(() => {\r\n            // console.log(this.checkedElement);\r\n\r\n            this.checkedElement.style.top = element.offsetTop + this.offsetHeight + 2 + 'px'\r\n            this.checkedElement.style.right = this.rootElement.offsetWidth - 20 + 'px';  // ? + (16 * 4)  \r\n        })\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * @param {Event} event\r\n     */\r\n    selectedChanged(event) {\r\n        //@ts-expect-error\r\n        if (event.target.tagName === 'li'.toUpperCase()) {\r\n            \r\n            (this.selectedElement || (this.selectedElement = this.rootElement.querySelector('.selected'))) && this.selectedElement.classList.remove('selected');\r\n            //@ts-expect-error\r\n            (this.selectedElement = event.target).classList.add('selected');\r\n\r\n            //@ts-expect-error\r\n            this.checkedElement && this.pickItem(event.target)\r\n\r\n            this.dispatchEvent(new CustomEvent(\"selected_changed\", {\r\n                detail: this.checkInfo = {\r\n                    //@ts-expect-error\r\n                    id: event.target.id,\r\n                    //@ts-expect-error\r\n                    metaId: event.target.dataset.id,\r\n                    //@ts-expect-error\r\n                    value: event.target.innerText,\r\n                }\r\n            }))\r\n        }\r\n    }\r\n\r\n    /**\r\n     * static constructor\r\n     */\r\n    static __contructor = (function () {\r\n        \r\n        document.body.insertAdjacentHTML('afterbegin', html`\r\n            <template id=\"choice-menu\">\r\n                <style>\r\n                    /* slotted need be styled inline */\r\n                    ::slotted(li),\r\n                    li {                \r\n                        color: white;\r\n                        background-color: #666;\r\n                        padding: 0.1em 1em 0.1em 2em;\r\n                        margin-top: 1px;\r\n                        position: relative;\r\n                    }\r\n\r\n                    ::slotted(ul), ul{\r\n                        margin: 0;\r\n                        padding-left: 0;\r\n                        position: absolute;\r\n                        top: 100%;\r\n                        right: .1em;\r\n                        width: max-content;\r\n                        list-style-type: none;\r\n                        transition: .3s;\r\n                        /* display: none; */\r\n                        \r\n                        overflow: hidden;\r\n                        height: 0;\r\n                    }\r\n\r\n                    /* стили применяемые к самому  my-paragraph*/\r\n                    :host {\r\n                        margin: 0em;\r\n                        /* margin-right: 2em; */\r\n                        position: relative;\r\n                    }\r\n\r\n                    ::slotted(.active), .active{\r\n                        /*display: block !important;*/\r\n\r\n                        height: 6em;                        \r\n                        display: block !important;\r\n                    }\r\n\r\n                    .selected::after, .checked{\r\n                        content: '';\r\n                        background: url(/static/images/check_mark.svg) no-repeat;\r\n                        background-size: contain;\r\n                        width: 1em;\r\n                        height: 2em;\r\n                        position: absolute;\r\n                        left: .5em;\r\n                        top: 0.15em;\r\n                    }\r\n\r\n                    .checked{\r\n                        left: auto;\r\n                        /* opacity: 0; */\r\n                        /* transition: opacity .3s ease .3s; */\r\n                        display: none; \r\n                        z-index: 5;\r\n                    }\r\n\r\n                </style>\r\n\r\n                <!-- <slot name=\"text\">My default text</slot> -->\r\n                <div class=\"checked\"></div>\r\n                <slot>\r\n                    <ul>\r\n                        <li class=\"selected\">item 1</li>\r\n                        <li>item 2</li>\r\n                    </ul>\r\n                </slot>\r\n\r\n            </template>\r\n        `);\r\n\r\n    })()\r\n\r\n}\r\n\r\n\r\n","export const modes = [\r\n    'html',\r\n    'css',\r\n    'javascript',\r\n    // 'typescript',\r\n]","// @ts-check\r\n\r\nimport { babelCompiler, compilers } from \"./features/compiler\";\r\nimport { generateGlobalInintializer, isPaired } from \"./utils/page_generator\";\r\nimport { commonStorage, getLangMode } from './utils/utils';\r\n\r\n// TODO REMOVE:\r\nimport { ChoiceMenu } from \"./ui/ChoiceMenu\";\r\nimport { modes as baseModes } from \"./features/base\";\r\n\r\n\r\nexport { compilers, babelCompiler };\r\n\r\n/**\r\n * @type {{editors: any[], iframe: any, curUrl: any, fileStorage: object, modes?: [object?, object?, object?], onfilerename?: Function, onfileRemove?: (name: string) => void}}\r\n */\r\nexport const playgroundObject = {\r\n    editors: [],\r\n    iframe: null,\r\n    curUrl: null,\r\n    fileStorage: { _active: 0 },\r\n    modes: null,\r\n    onfilerename: null,\r\n    onfileRemove: null\r\n}\r\n\r\n\r\n/**\r\n * @param {{ [x: string]: string; }} [attrs]\r\n */\r\nfunction createHtml({ body, style, script, link }, attrs) {\r\n\r\n    // globalThis.__debug && console.log(arguments);\r\n\r\n    const htmlStruct = {\r\n        html: {\r\n            head: {\r\n                style,\r\n                script,\r\n                link\r\n            },\r\n            body\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {{ [x: string]: any; html?: { head: { [x: string]: string; script: string; }; body: any; }; }} nodeStruct\r\n     */\r\n    function nodeCreate(nodeStruct) {\r\n\r\n        let html = '';\r\n        for (const key in nodeStruct) {\r\n\r\n            let _attrs = attrs[key] || '';\r\n            let content = typeof nodeStruct[key] === typeof nodeStruct\r\n                ? nodeCreate(nodeStruct[key])\r\n                : (nodeStruct[key] || '');\r\n\r\n            html += content !== null\r\n                ? ('<' + key + _attrs + '>' + content + '</' + key + '>')\r\n                : ('<' + key + _attrs + '/>');\r\n\r\n        }\r\n        return html;\r\n    }\r\n\r\n    return nodeCreate(htmlStruct);\r\n}\r\n\r\n\r\n/**\r\n * \r\n * TODO: option {simplestBundler, fileStore}\r\n * \r\n * @param {string} [prevUrl]\r\n * @param {string[]} [additionalScripts]\r\n * @param {string} [scriptType]\r\n * @param {object} [options]\r\n * @returns {[HTMLElement, string]}\r\n */\r\nexport function createPage(prevUrl, additionalScripts, scriptType, options) {    \r\n    \r\n    // alert(99)\r\n    if ((playgroundObject.fileStorage || window['fileStore']) && playgroundObject.editors) {\r\n        const fileStorage = playgroundObject.fileStorage || window['fileStore'];\r\n        let activeTab = document.querySelector('.tabs .tab.active');\r\n        // update current tab content:\r\n\r\n        if (fileStorage) {\r\n            fileStorage[fileStorage.innerText] = playgroundObject.editors[2].getValue()\r\n        }        \r\n    }\r\n    \r\n    let _fs = (playgroundObject.fileStorage || window['fileStore'] || {});\r\n    let appCode = _fs['app.js'] || _fs['app.ts'] || playgroundObject.fileStorage[undefined + ''];\r\n    // globalThis.__debug && console.log('appCode');\r\n\r\n\r\n    const langMode = getLangMode(appCode);\r\n    if (langMode) {\r\n\r\n        var currentLang = playgroundObject.modes && playgroundObject.modes[2] && playgroundObject.modes[2][langMode];\r\n\r\n        if (currentLang && currentLang.src && currentLang.target === 'self') {\r\n            \r\n            let scriptID = currentLang.src.split('/').pop().split('.').shift();\r\n            let originScript = document.getElementById(scriptID)\r\n            if (!originScript) {\r\n                originScript = document.createElement('script');\r\n                //@ts-ignore\r\n                originScript.src = currentLang.src;\r\n                originScript.onload = () => {\r\n\r\n                    // createPage(prevUrl, additionalScripts, scriptType, options);\r\n                    waiting.parentElement.removeChild(waiting);\r\n                }\r\n                document.head.appendChild(originScript);\r\n                let waiting = document.querySelector('.view').appendChild(document.createElement('div'))\r\n                waiting.innerText = 'Ожидание...'\r\n                waiting.id = 'view__waiting';                \r\n                // return;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    let buildJS = (/** @type {string} */ code) => {        \r\n\r\n        // convert to js:   \r\n\r\n        if (window['simplestBundler']) {\r\n            code = window['simplestBundler'].default(code, playgroundObject.fileStorage || window['fileStore']);\r\n            globalThis.__debug && console.log('build...');\r\n        }\r\n        else {\r\n            console.warn('bundler is absent');\r\n            // alert('Warn/ look logs')\r\n        }        \r\n\r\n        // ts transpilation:\r\n        if (currentLang && currentLang.compileFunc) {\r\n            code = currentLang.compileFunc(code);\r\n        }\r\n\r\n        // \r\n        let globalReinitializer = generateGlobalInintializer(code);\r\n\r\n        code = 'window.addEventListener(\"' + (scriptType ? 'load' : 'DOMContentLoaded') + '\", function(){' + code + '\\n\\n' + globalReinitializer + '\\n});';\r\n\r\n        // customLOG\r\n        const logJar = document.querySelector('.console .lines');\r\n        if (logJar) {\r\n\r\n            logJar.innerHTML = '';\r\n\r\n            function customLOG(/** @type {string} */ value) {\r\n                let line = window.parent.document.querySelector('.console .lines').appendChild(document.createElement('div'));\r\n                line.innerText = typeof value === 'object' ? JSON.stringify(value) : value;\r\n                globalThis.__debug && console.log([].slice.call(arguments).join())\r\n            }\r\n\r\n            code = customLOG.toString() + '\\n\\n' + code.replace(/globalThis.__debug && console.log/g, 'customLOG');\r\n        }        \r\n\r\n        return code;\r\n    }\r\n\r\n\r\n    // при concat все равно скопируется\r\n    // additionalScripts = additionalScripts.slice()\r\n    \r\n    \r\n    const editors = playgroundObject.editors;\r\n    const baseTags = ['body', 'style', 'script'];\r\n    const attrs = {\r\n        script: scriptType\r\n    }\r\n\r\n    // compilerSubModes дополняем:\r\n    if (playgroundObject.modes && playgroundObject.modes.length) playgroundObject.editors.forEach((editor, i) => {\r\n\r\n        /**\r\n         * @type ChoiceMenu\r\n         */\r\n        let modeMenu = editor.container.querySelector('choice-menu');\r\n        if (modeMenu) {\r\n            /**\r\n             * @type {{src: string|string[], target?: {tag: string, attributes: string, outline?: true}}}\r\n             */\r\n            let actualMode = playgroundObject.modes[i][modeMenu.selectedElement.innerText]\r\n            if (actualMode) {                \r\n                additionalScripts = (additionalScripts || []).concat(typeof actualMode.src === 'string' ? [actualMode.src] : actualMode.src)\r\n            }\r\n            \r\n            if (actualMode && actualMode.target) {\r\n                \r\n                /// possibility change style tag to link tag:\r\n                if (actualMode.target.tag) baseTags[i] = actualMode.target.tag;\r\n\r\n                if (actualMode.target.outline) {\r\n                    // create link\r\n                    let blob = new Blob([editors[i].getValue()], { type: 'text/' + baseModes[i] });\r\n                    let link = URL.createObjectURL(blob);\r\n                    actualMode.target.attributes = actualMode.target.attributes.replace('{}', link)\r\n                }\r\n                if (actualMode.target.attributes) attrs[baseTags[i]] = actualMode.target.attributes;\r\n            }\r\n        }\r\n    })\r\n\r\n    \r\n    /// TODO? @import 'style.css' to style html tag from link file?\r\n    \r\n    let htmlContent = baseTags.reduce((acc, el, i, arr) => (\r\n        (\r\n            acc[el] = i < 2\r\n                ? isPaired(el) ? editors[i].getValue() : null\r\n                : buildJS(appCode || editors[i].getValue())\r\n        ), acc),\r\n        {}\r\n    );\r\n\r\n    let optionalScripts = ''\r\n    if (additionalScripts && additionalScripts.length) {\r\n        for (let i = 0; i < additionalScripts.length; i++) {\r\n            // htmlContent['body'] += '<script src=\"' + additionalScripts[i] + '\"></script>';\r\n            optionalScripts += '<script src=\"' + additionalScripts[i] + '\"></script>';\r\n        }\r\n    }\r\n    // globalThis.__debug && console.log(htmlContent);    \r\n\r\n\r\n    // @ts-ignore\r\n    globalThis.__debug && console.log('html');\r\n    let html = createHtml(htmlContent, attrs);\r\n\r\n    globalThis.__debug && console.log(optionalScripts);\r\n    html = html.replace('</head>', optionalScripts + '</head>');\r\n    html = html.replace('<head>', '<head><meta charset=\"UTF-8\">');\r\n\r\n    let file = new Blob([html], { type: 'text/html' });\r\n\r\n    prevUrl && URL.revokeObjectURL(prevUrl);\r\n    let url = URL.createObjectURL(file);\r\n\r\n    let view = document.querySelector('.view');\r\n    playgroundObject.iframe && (playgroundObject.iframe.parentElement === view) && view.removeChild(playgroundObject.iframe);\r\n    // view.innerHTML = '';    \r\n\r\n    let frame = document.createElement('iframe');\r\n    frame.src = url;\r\n    view.appendChild(frame)\r\n\r\n    return [frame, url]\r\n}\r\n\r\n\r\n/**\r\n * // @param {(url: string) => [HTMLIFrameElement, string]} [createPageFunc]\r\n * @param {boolean} jsxMode\r\n * ///! param {number} compilerMode\r\n * @param {string[]} compilerModes - \r\n * \r\n * TODO: options: {storage (localStorage|sessionStorage), fileStore}\r\n */\r\nexport function webCompile(jsxMode, compilerModes) {\r\n\r\n    globalThis.__debug && console.log('compile');\r\n\r\n    // [iframe, curUrl] = createPage(curUrl);\r\n    // globalThis.__debug && console.log(iframe);\r\n\r\n\r\n\r\n    let iframe = playgroundObject.iframe,\r\n        editors = playgroundObject.editors;\r\n\r\n    const fileStorage = playgroundObject.fileStorage || window['fileStore'];\r\n    //@ts-ignore\r\n    if (Object.keys(fileStorage || {}).length) {\r\n        let activeTab = document.querySelector('.tabs .tab.active');\r\n        //@ts-ignore\r\n        if (activeTab) fileStorage[activeTab.innerText] = editors[2].getValue()\r\n        // else {\r\n        //     fileStorage[undefined + ''] = editors[2].getValue()\r\n        // }\r\n    }\r\n\r\n\r\n\r\n\r\n    if (iframe.contentDocument && !jsxMode && false) {\r\n        \r\n        iframe.contentDocument.body.innerHTML = editors[0].getValue()\r\n        iframe.contentDocument.head.querySelector('style').innerHTML = editors[1].getValue()\r\n\r\n        let lastScript = [].slice.call(iframe.contentDocument.querySelectorAll('script')).pop();\r\n        lastScript && lastScript.parentElement.removeChild(lastScript);\r\n\r\n        // let lastScripts = iframe.contentDocument.querySelectorAll('script');\r\n        // lastScripts && lastScripts.length && Array.prototype.slice.call(lastScripts).forEach((/** @type {{ parentElement: { removeChild: (arg: any) => void; }; }} */ element) =>\r\n        // {\r\n        //     element.parentElement.removeChild(element);\r\n        // });\r\n        \r\n        let script = iframe.contentDocument.createElement('script');\r\n        \r\n        globalThis.__debug && console.log(jsxMode)\r\n        globalThis.__debug && console.log(compilerModes);\r\n\r\n        if (jsxMode) {\r\n            \r\n            // for (let i = 0; i < compilerMode.length; i++) {\r\n            //     const link = compilerMode[i];\r\n\r\n            //     let jsxCompiler = iframe.contentDocument.createElement('script');\r\n            //     jsxCompiler.src = link;\r\n            //     iframe.contentDocument.body.appendChild(jsxCompiler);\r\n            // }\r\n\r\n            script.type = \"text/babel\";\r\n        }\r\n\r\n        let code = playgroundObject.fileStorage['app.js'] || playgroundObject.fileStorage['app.ts'] || editors[2].getValue();\r\n\r\n        let globalReinitializer = generateGlobalInintializer(code)\r\n\r\n        script.innerHTML = '(function(){' + code + ';\\n\\n' + globalReinitializer + '\\n})()'\r\n        iframe.contentDocument.body.appendChild(script)\r\n\r\n        // iframe.contentDocument.head.querySelector('script').innerHTML = editors[2].getValue()\r\n    }\r\n    else {\r\n        // globalThis.__debug && console.log(compilerMode);\r\n        // globalThis.__debug && console.log(Object.values(compilers)[compilerMode]);\r\n        // let [iframe, curUrl] = createPage(playgroundObject.curUrl, Object.values(compilers)[compilerMode], jsxMode ? babelCompiler.mode : undefined);\r\n        let [iframe, curUrl] = createPage(playgroundObject.curUrl, compilerModes, jsxMode ? babelCompiler.mode : undefined);\r\n        playgroundObject.iframe = iframe;\r\n        playgroundObject.curUrl = curUrl;\r\n    }\r\n\r\n\r\n\r\n\r\n    let compiler = Number.parseInt((commonStorage || localStorage).getItem('mode') || '0');\r\n\r\n    // just sandbox feature:\r\n    (commonStorage || localStorage).setItem(compiler + '__html', editors[0].getValue());\r\n    (commonStorage || localStorage).setItem(compiler + '__css', editors[1].getValue());\r\n    (commonStorage || localStorage).setItem(compiler + '__javascript', editors[2].getValue());\r\n    \r\n\r\n\r\n    let modulesStore = {};\r\n\r\n    console.log('save modules...')\r\n\r\n    if (fileStorage && Object.keys(fileStorage).length > 1) {\r\n        \r\n        for (let i = 0; i < Object.keys(fileStorage).length; i++) {\r\n            const fileName = Object.keys(fileStorage)[i];\r\n            if (fileName.startsWith('_')) continue;\r\n            modulesStore[fileName] = fileStorage[fileName];\r\n        }\r\n\r\n        // js multitabs:\r\n        (commonStorage || localStorage).setItem('_modules', JSON.stringify(modulesStore));\r\n        globalThis.__debug && console.log('save modules...');\r\n    }\r\n\r\n    // document.getElementById('compiler_mode')\r\n}\r\n\r\n\r\n\r\n"],"names":["baseModes"],"mappings":"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"}